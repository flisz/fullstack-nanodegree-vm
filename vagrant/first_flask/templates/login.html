<!DOCTYPE html>
<html>
<head>
<script src="https://apis.google.com/js/platform.js" async defer> </script>
<meta name="google-signin-client_id" content="{{oauth_client_id}}">
</head>
<body>  
        <div id="signinButton">
          <div class="g-signin2" data-onsuccess="onSignIn"></div>
        </div>
<script>
  function onSignIn(authResult) {
    if authResult['code']){
  //hide sign in button
  $('#signinButton').attr('style','display: none');
  //send the one-time-use code to the server, if the server responds, write a 'login successful' message to the web page and then redirect back to the main restaurants page
  $.ajax({
    type: 'POST',
    url: '/gconnect?state={{STATE}}',
    processData: false,
    contentType: 'application/octet-stream; charset=utf-8',
    success: function(result){
      if (result) {
        $('#result').html('Login Successful!</br>'+result+'</br> Redirecting --> -->')
        setTimeout(function() {
          window.location.href = "/restaurant";}
        , 4000);
      } else if (authResult['error']) {
        console.log('There was an error: ' + authResult['error']);
      } else {
        $('#result').html('Failed to make a server-side call. Check your configuration and console.')
      }
    }
  })
}
  }
</body>
</html>